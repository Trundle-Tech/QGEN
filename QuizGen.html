<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OSHA Focus Four - Adaptive Quiz</title>
    <style>
        :root {
            --primary: #d32f2f; /* OSHA Red-ish */
            --secondary: #333;
            --light: #f4f4f4;
            --correct: #2e7d32;
            --wrong: #c62828;
        }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; line-height: 1.6; margin: 0; padding: 20px; background: #fff; color: #333; }
        .container { max-width: 800px; margin: 0 auto; }
        
        /* State Views */
        .view { display: none; }
        .active { display: block; animation: fadeIn 0.5s; }

        /* Card Styles */
        .card { border: 1px solid #ddd; border-radius: 8px; padding: 20px; margin-bottom: 20px; background: #fff; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        h1, h2 { color: var(--secondary); }
        h1 { text-align: center; margin-bottom: 30px; }

        /* Quiz Styles */
        .question-text { font-size: 1.2em; font-weight: bold; margin-bottom: 15px; }
        .options { list-style: none; padding: 0; }
        .option { background: var(--light); padding: 15px; margin-bottom: 10px; border-radius: 5px; cursor: pointer; transition: 0.2s; border: 2px solid transparent; }
        .option:hover { background: #e0e0e0; }
        .option.selected { border-color: var(--primary); background: #ffebee; }

        /* Review Styles */
        .review-item { border-left: 5px solid var(--primary); padding-left: 20px; margin-bottom: 40px; }
        .review-context { background: #f9f9f9; padding: 15px; border-radius: 5px; margin-top: 10px; }
        .review-context img { max-width: 100%; height: auto; border-radius: 5px; margin: 10px 0; border: 1px solid #ddd; }
        .review-context h4 { margin-top: 0; color: #666; }

        /* Buttons */
        .btn { display: block; width: 100%; padding: 15px; background: var(--primary); color: #fff; border: none; border-radius: 5px; font-size: 1.1em; cursor: pointer; text-align: center; }
        .btn:hover { background: #b71c1c; }
        .btn-outline { background: transparent; border: 2px solid var(--primary); color: var(--primary); }
        .btn-outline:hover { background: var(--primary); color: #fff; }

        /* Progress Bar */
        .progress-container { height: 10px; background: #ddd; border-radius: 5px; margin-bottom: 20px; overflow: hidden; }
        .progress-bar { height: 100%; background: var(--primary); width: 0%; transition: width 0.3s; }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body>

<div class="container">
    <h1>OSHA Focus Four: Adaptive Assessment</h1>

    <div id="view-intro" class="view active">
        <div class="card">
            <h2>Welcome</h2>
            <p>This is an adaptive quiz designed to test your knowledge of OSHA's Focus Four Hazards. </p>
            <ul>
                <li>Answer all questions.</li>
                <li>If you miss any, you will enter <strong>Review Mode</strong>.</li>
                <li>Review the specific course content you missed.</li>
                <li>Retake <em>only</em> the missed questions until you achieve 100%.</li>
            </ul>
            <button class="btn" onclick="app.startQuiz()">Start Quiz</button>
        </div>
    </div>

    <div id="view-quiz" class="view">
        <div class="progress-container">
            <div class="progress-bar" id="progress-bar"></div>
        </div>
        <div class="card">
            <div id="quiz-container">
                </div>
            <button class="btn" id="submit-btn" onclick="app.submitAnswer()">Submit Answer</button>
        </div>
    </div>

    <div id="view-review" class="view">
        <div class="card">
            <h2 id="score-header"></h2>
            <p>Please review the material below for the questions you missed.</p>
        </div>
        <div id="review-list">
            </div>
        <button class="btn" onclick="app.retakeMissed()">Retake Missed Questions</button>
    </div>

    <div id="view-victory" class="view">
        <div class="card" style="text-align: center;">
            <h2 style="color: var(--correct);">Course Complete!</h2>
            <p>You have successfully mastered all topics in the OSHA Focus Four Hazards training.</p>
            <div style="font-size: 4em;">üèÜ</div>
            <p>100% Mastery Achieved</p>
        </div>
    </div>
</div>

<script>
/**
 * EXTRACTED DATA FROM UPLOADED COURSE
 * This JSON object contains the Question, Answers, Correct Index, 
 * and the specific Lesson Content (HTML) relevant to that question.
 */
const quizData = [
  {
    "id": "q1",
    "lesson": "Falls",
    "question": "From what heights do vertical drops in the construction industry become especially dangerous?",
    "options": [
      "2 feet or more",
      "4 feet or more",
      "6 feet or more",
      "8 feet or more"
    ],
    "correct": 2, // Index of "6 feet or more"
    "reviewHTML": `
        <h4>Lesson Context: Falls</h4>
        <p><strong>How High Is Too High?</strong></p>
        <p>Within the construction industry, vertical drops over <strong>6 feet</strong> are especially dangerous. Workers should always use fall protection when exposed to heights over 6 feet.</p>
        <div style="background:#eee; padding:10px; margin-top:5px; border-left:4px solid #333;">
            <em>Note: OSHA generally requires fall protection at elevations of 6 feet or greater in construction.</em>
        </div>
    `
  },
  {
    "id": "q2",
    "lesson": "Identifying Fall Hazards",
    "question": "Is this a fall hazard? (Image: Worker near edge without protection)",
    "options": ["Yes", "No"],
    "correct": 0,
    "reviewHTML": `
        <h4>Lesson Context: Identifying Fall Hazards</h4>
        <p><strong>Unprotected Sides and Edges</strong></p>
        <p>One of the major fall hazards is working near unprotected sides, edges, openings, or floor holes. If a worker can fall 6 feet or more, protection is required.</p>
        <img src="assets/534220.jpg" alt="Worker near edge" style="max-height:200px; display:block; margin:auto;">
    `
  },
  {
    "id": "q3",
    "lesson": "Identifying Fall Hazards",
    "question": "Is this a fall hazard? (Image: Worker on ladder)",
    "options": ["Yes", "No"],
    "correct": 0,
    "reviewHTML": `
        <h4>Lesson Context: Identifying Fall Hazards</h4>
        <p><strong>Unsafe Portable Ladder Use</strong></p>
        <p>Falls often occur when ladders move, slip, or when workers overreach or lose balance. Defective equipment or improper selection also contributes to hazards.</p>
        <img src="assets/9512003.jpg" alt="Ladder Hazard" style="max-height:200px; display:block; margin:auto;">
    `
  },
  {
    "id": "q4",
    "lesson": "Identifying Fall Hazards",
    "question": "Is this a fall hazard? (Image: Scaffolding)",
    "options": ["Yes", "No"],
    "correct": 0,
    "reviewHTML": `
        <h4>Lesson Context: Identifying Fall Hazards</h4>
        <p><strong>Improper Scaffold Construction</strong></p>
        <p>Scaffolds must have proper planking, stable footing, and guardrails. Weak supports or lack of access are major hazards.</p>
        <img src="assets/8829869.jpg" alt="Scaffold Hazard" style="max-height:200px; display:block; margin:auto;">
    `
  },
  {
    "id": "q5",
    "lesson": "Identifying Fall Hazards",
    "question": "Is this a fall hazard? (Image: Roof work)",
    "options": ["Yes", "No"],
    "correct": 0,
    "reviewHTML": `
        <h4>Lesson Context: Identifying Fall Hazards</h4>
        <p><strong>Roofing Work</strong></p>
        <p>Work on roofs carries inherent fall risks due to slope and height. Proper fall arrest systems or guardrails must be used.</p>
        <img src="assets/2317640.jpg" alt="Roof Hazard" style="max-height:200px; display:block; margin:auto;">
    `
  },
  {
    "id": "q6",
    "lesson": "Struck-By Hazards",
    "question": "Is this a struck-by hazard? (Image: Suspended Load)",
    "options": ["Yes", "No"],
    "correct": 0,
    "reviewHTML": `
        <h4>Lesson Context: Struck-By Hazards</h4>
        <p><strong>Flying, Falling, Swinging, or Rolling Objects</strong></p>
        <p>"Struck-by" injuries are produced by forcible contact or impact between the injured person and an object or piece of equipment.</p>
        <p><strong>Common Causes:</strong> Flying objects (from tools), Falling objects (from heights), Swinging objects (cranes), or Rolling objects (vehicles).</p>
        <img src="assets/18576025.jpg" alt="Suspended Load" style="max-height:200px; display:block; margin:auto;">
    `
  },
  {
    "id": "q7",
    "lesson": "Struck-By Hazards",
    "question": "Is this a struck-by hazard? (Image: Vehicle Traffic)",
    "options": ["Yes", "No"],
    "correct": 0,
    "reviewHTML": `
        <h4>Lesson Context: Struck-By Hazards</h4>
        <p><strong>Motor Vehicles</strong></p>
        <p>Workers are at risk of being struck by trucks, cars, or heavy equipment. This includes being run over or struck by swinging backhoes.</p>
        <img src="assets/8829875.jpg" alt="Vehicle Traffic" style="max-height:200px; display:block; margin:auto;">
    `
  },
   {
    "id": "q8",
    "lesson": "Struck-By Hazards",
    "question": "Is this a struck-by hazard? (Image: Flying Debris)",
    "options": ["Yes", "No"],
    "correct": 0,
    "reviewHTML": `
        <h4>Lesson Context: Struck-By Hazards</h4>
        <p><strong>Flying Objects</strong></p>
        <p>Objects can be propelled through space by tools or machinery. Powder-actuated tools are particularly dangerous as they drive fasteners with explosive force.</p>
        <img src="assets/34025501.jpg" alt="Flying Debris" style="max-height:200px; display:block; margin:auto;">
    `
  },
    {
    "id": "q9",
    "lesson": "Caught-In/Between Hazards",
    "question": "Is this a caught hazard? (Image: Trench)",
    "options": ["Yes", "No"],
    "correct": 0,
    "reviewHTML": `
        <h4>Lesson Context: Caught-In or -Between</h4>
        <p><strong>Cave-Ins</strong></p>
        <p>Unprotected trenches and excavations pose a high risk of cave-ins, which can crush or suffocate workers. This is a classic "Caught-In" hazard.</p>
        <img src="assets/8885116.jpg" alt="Trench" style="max-height:200px; display:block; margin:auto;">
    `
  },
  {
    "id": "q10",
    "lesson": "Caught-In/Between Hazards",
    "question": "Is this a caught hazard? (Image: Gears/Machinery)",
    "options": ["Yes", "No"],
    "correct": 0,
    "reviewHTML": `
        <h4>Lesson Context: Caught-In or -Between</h4>
        <p><strong>Unguarded Machinery</strong></p>
        <p>Injuries result from a person being squeezed, pinched, or compressed between two or more objects. Unguarded moving parts like gears and belts are major culprits.</p>
        <img src="assets/8817847.jpg" alt="Machinery" style="max-height:200px; display:block; margin:auto;">
    `
  },
  {
    "id": "q11",
    "lesson": "Caught-In/Between Hazards",
    "question": "Is this a caught hazard? (Image: Heavy Equipment)",
    "options": ["Yes", "No"],
    "correct": 0,
    "reviewHTML": `
        <h4>Lesson Context: Caught-In or -Between</h4>
        <p><strong>Pinned Between</strong></p>
        <p>Workers can be pinned between equipment and a solid object (like a wall or another piece of equipment). Never place yourself between a moving hazard and a stationary object.</p>
        <img src="assets/5668922.jpg" alt="Heavy Equipment" style="max-height:200px; display:block; margin:auto;">
    `
  },
  {
    "id": "q12",
    "lesson": "Caught-In/Between Hazards",
    "question": "Is this a caught hazard? (Image: Rotating parts)",
    "options": ["Yes", "No"],
    "correct": 0,
    "reviewHTML": `
        <h4>Lesson Context: Caught-In or -Between</h4>
        <p><strong>Rotating Parts</strong></p>
        <p>Clothing, jewelry, or hair can get caught in rotating machinery, pulling the worker in. Ensure all guards are in place.</p>
        <img src="assets/8853525.jpg" alt="Rotating Parts" style="max-height:200px; display:block; margin:auto;">
    `
  },
  {
    "id": "q13",
    "lesson": "Electrocution Hazards",
    "question": "Is this an electrocution hazard? (Image: Overhead lines)",
    "options": ["Yes", "No"],
    "correct": 0,
    "reviewHTML": `
        <h4>Lesson Context: Electrocution</h4>
        <p><strong>Overhead Power Lines</strong></p>
        <p>Contact with overhead power lines is a leading cause of electrocution. Equipment (cranes, ladders) touching lines can be fatal.</p>
        <img src="assets/0130754.jpg" alt="Overhead lines" style="max-height:200px; display:block; margin:auto;">
    `
  },
  {
    "id": "q14",
    "lesson": "Electrocution Hazards",
    "question": "Is this an electrocution hazard? (Image: Damaged Cord)",
    "options": ["Yes", "No"],
    "correct": 0,
    "reviewHTML": `
        <h4>Lesson Context: Electrocution</h4>
        <p><strong>Damaged Cords</strong></p>
        <p>Extension and flexible cords with exposed wires or damaged insulation create shock and burn hazards. Always inspect cords before use.</p>
        <img src="assets/8005368.jpg" alt="Damaged Cord" style="max-height:200px; display:block; margin:auto;">
    `
  },
  {
    "id": "q15",
    "lesson": "Electrocution Hazards",
    "question": "Is this an electrocution hazard? (Image: Panel Box)",
    "options": ["Yes", "No"],
    "correct": 0,
    "reviewHTML": `
        <h4>Lesson Context: Electrocution</h4>
        <p><strong>Energized Sources</strong></p>
        <p>Contact with energized sources like open panel boxes or live wires leads to electrical shock, burns, and electrocution. Only qualified personnel should work on live equipment.</p>
        <img src="assets/7081425.jpg" alt="Panel Box" style="max-height:200px; display:block; margin:auto;">
    `
  },
  {
    "id": "q16",
    "lesson": "Electrocution Hazards",
    "question": "Is this an electrocution hazard? (Image: Wet conditions)",
    "options": ["Yes", "No"],
    "correct": 0,
    "reviewHTML": `
        <h4>Lesson Context: Electrocution</h4>
        <p><strong>Wet Conditions</strong></p>
        <p>All electrical hazards are worse in wet or damp conditions. Water conducts electricity, significantly increasing the risk of shock.</p>
        <img src="assets/7397169.jpg" alt="Wet conditions" style="max-height:200px; display:block; margin:auto;">
    `
  }
];

/**
 * APP LOGIC
 */
const app = {
    // State
    currentQueue: [],
    missedIds: [],
    currentIndex: 0,
    selectedOption: null,

    // Init
    init: function() {
        // Load all IDs into queue initially
        this.currentQueue = quizData.map(q => q.id);
        this.showView('view-intro');
    },

    // Navigation
    showView: function(viewId) {
        document.querySelectorAll('.view').forEach(el => el.classList.remove('active'));
        document.getElementById(viewId).classList.add('active');
    },

    startQuiz: function() {
        this.currentIndex = 0;
        this.missedIds = [];
        this.renderQuestion();
        this.showView('view-quiz');
    },

    // Rendering
    renderQuestion: function() {
        const qData = this.getQuestionData(this.currentQueue[this.currentIndex]);
        const container = document.getElementById('quiz-container');
        
        // Update Progress
        const percent = ((this.currentIndex) / this.currentQueue.length) * 100;
        document.getElementById('progress-bar').style.width = percent + '%';

        // Build HTML
        let html = `<div class="question-text">${qData.question}</div>`;
        html += `<ul class="options">`;
        qData.options.forEach((opt, index) => {
            html += `<li class="option" onclick="app.selectOption(${index}, this)">${opt}</li>`;
        });
        html += `</ul>`;
        
        container.innerHTML = html;
        document.getElementById('submit-btn').disabled = true;
        document.getElementById('submit-btn').style.opacity = 0.5;
        this.selectedOption = null;
    },

    getQuestionData: function(id) {
        return quizData.find(q => q.id === id);
    },

    selectOption: function(index, el) {
        this.selectedOption = index;
        // Visuals
        document.querySelectorAll('.option').forEach(o => o.classList.remove('selected'));
        el.classList.add('selected');
        // Enable submit
        const btn = document.getElementById('submit-btn');
        btn.disabled = false;
        btn.style.opacity = 1;
    },

    submitAnswer: function() {
        const qId = this.currentQueue[this.currentIndex];
        const qData = this.getQuestionData(qId);

        // Logic
        if (this.selectedOption !== qData.correct) {
            this.missedIds.push(qId);
        }

        // Next
        this.currentIndex++;
        if (this.currentIndex < this.currentQueue.length) {
            this.renderQuestion();
        } else {
            this.finishRound();
        }
    },

    finishRound: function() {
        if (this.missedIds.length === 0) {
            this.showView('view-victory');
        } else {
            this.renderReview();
            this.showView('view-review');
        }
    },

    // Review Logic
    renderReview: function() {
        const list = document.getElementById('review-list');
        const score = Math.round(((this.currentQueue.length - this.missedIds.length) / this.currentQueue.length) * 100);
        
        document.getElementById('score-header').innerText = `You scored ${score}%. Review the ${this.missedIds.length} missed topics:`;
        
        list.innerHTML = '';

        this.missedIds.forEach(id => {
            const qData = this.getQuestionData(id);
            const div = document.createElement('div');
            div.className = 'review-item';
            div.innerHTML = `
                <div style="font-weight:bold; color:#d32f2f;">Missed Question:</div>
                <div>${qData.question}</div>
                <div class="review-context">
                    ${qData.reviewHTML}
                </div>
            `;
            list.appendChild(div);
        });
    },

    retakeMissed: function() {
        // Reset queue to only missed questions
        this.currentQueue = [...this.missedIds];
        this.startQuiz();
    }
};

// Start
app.init();

</script>

</body>
</html>